DELIMITER //
CREATE FUNCTION calculate_discount
(cust_id CHAR(8)) RETURNS DECIMAL(10,2)
COMMENT 'Calculate Customers discount'
BEGIN
 DECLARE total DECIMAL(10,2);
 DECLARE discount DECIMAL(10,2);
 SELECT SUM(amount) INTO total FROM payments WHERE customerNumber = cust_id;
 SET discount = total * .05;
 RETURN discount;
END //
DELIMITER ;